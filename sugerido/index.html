<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Timer com Mensagem</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      background-color: #f0f0f0;
    }
    .container {
      text-align: center;
    }
    .hidden {
      display: none;
    }
    input[type="text"], textarea {
      width: 200px;
      padding: 10px;
      margin: 10px auto;
      display: block;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      border: none;
      background-color: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    #timerDisplay {
      font-size: 48px;
      margin-bottom: 20px;
    }
    #charCount {
      font-size: 12px;
      color: #555;
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="formSection">
      <input type="text" id="timeInput" placeholder="hh:mm:ss" required maxlength="8" />
      <textarea id="messageInput" maxlength="200" placeholder="Digite sua mensagem (máx. 200 caracteres)" required></textarea>
      <div id="charCount">200 caracteres restantes</div>
      <button id="defineBtn">Definir</button>
    </div>

    <div id="timerSection" class="hidden">
      <div id="timerDisplay">00:00:00</div>
      <div>
        <button id="startBtn">Start</button>
        <button id="pauseBtn" class="hidden">Pause</button>
        <button id="resetBtn">Reset</button>
        <button id="settingsBtn">Settings</button>
      </div>
    </div>

    <div id="messageSection" class="hidden">
      <h1 id="finalMessage"></h1>
      <button id="newTimerBtn">Novo Timer</button>
    </div>
  </div>

  <script>
    const timeInput = document.getElementById("timeInput");
    const messageInput = document.getElementById("messageInput");
    const charCount = document.getElementById("charCount");
    const defineBtn = document.getElementById("defineBtn");
    const formSection = document.getElementById("formSection");
    const timerSection = document.getElementById("timerSection");
    const timerDisplay = document.getElementById("timerDisplay");
    const startBtn = document.getElementById("startBtn");
    const pauseBtn = document.getElementById("pauseBtn");
    const resetBtn = document.getElementById("resetBtn");
    const settingsBtn = document.getElementById("settingsBtn");
    const messageSection = document.getElementById("messageSection");
    const finalMessage = document.getElementById("finalMessage");
    const newTimerBtn = document.getElementById("newTimerBtn");

    let totalSeconds = 0;
    let initialSeconds = 0;
    let interval = null;

    // Máscara de tempo (hh:mm:ss)
    timeInput.addEventListener("input", (e) => {
      let v = e.target.value.replace(/[^0-9]/g, "");
      if (v.length >= 6) {
        e.target.value = v.replace(/(\d{2})(\d{2})(\d{2})/, "$1:$2:$3");
      } else if (v.length >= 4) {
        e.target.value = v.replace(/(\d{2})(\d{2})/, "$1:$2");
      }
    });

    // Contador de caracteres
    messageInput.addEventListener("input", () => {
      const remaining = 200 - messageInput.value.length;
      charCount.textContent = `${remaining} caracteres restantes`;
    });

    defineBtn.addEventListener("click", () => {
      if (!timeInput.value || !messageInput.value) {
        alert("Preencha o tempo e a mensagem!");
        return;
      }

      const [hh, mm, ss] = timeInput.value.split(":").map(Number);
      totalSeconds = hh * 3600 + mm * 60 + ss;
      initialSeconds = totalSeconds;

      if (isNaN(totalSeconds) || totalSeconds <= 0) {
        alert("Tempo inválido!");
        return;
      }

      updateTimerDisplay();
      formSection.classList.add("hidden");
      timerSection.classList.remove("hidden");
    });

    startBtn.addEventListener("click", () => {
      interval = setInterval(() => {
        totalSeconds--;
        updateTimerDisplay();
        if (totalSeconds <= 0) {
          clearInterval(interval);
          timerSection.classList.add("hidden");
          messageSection.classList.remove("hidden");
          finalMessage.textContent = messageInput.value;
        }
      }, 1000);
      startBtn.classList.add("hidden");
      pauseBtn.classList.remove("hidden");
    });

    pauseBtn.addEventListener("click", () => {
      clearInterval(interval);
      pauseBtn.classList.add("hidden");
      startBtn.classList.remove("hidden");
    });

    resetBtn.addEventListener("click", () => {
      clearInterval(interval);
      totalSeconds = initialSeconds;
      updateTimerDisplay();
      pauseBtn.classList.add("hidden");
      startBtn.classList.remove("hidden");
    });

    settingsBtn.addEventListener("click", resetToSettings);
    newTimerBtn.addEventListener("click", resetToSettings);

    function resetToSettings() {
      clearInterval(interval);
      totalSeconds = 0;
      initialSeconds = 0;
      messageInput.value = "";
      timeInput.value = "";
      charCount.textContent = "200 caracteres restantes";
      formSection.classList.remove("hidden");
      timerSection.classList.add("hidden");
      messageSection.classList.add("hidden");
    }

    function updateTimerDisplay() {
      const h = String(Math.floor(totalSeconds / 3600)).padStart(2, "0");
      const m = String(Math.floor((totalSeconds % 3600) / 60)).padStart(2, "0");
      const s = String(totalSeconds % 60).padStart(2, "0");
      timerDisplay.textContent = `${h}:${m}:${s}`;
    }
  </script>
</body>
</html>
